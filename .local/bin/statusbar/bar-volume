#!/usr/bin/env bash
# signal 5

VOLUME_ON_ICON='ï€¨'
VOLUME_MUTED_ICON='ï€¦'

mute(){
    isMuted=$(pactl get-sink-mute @DEFAULT_SINK@)

    if [ "${isMuted}" = 'Mute: yes' ]; then
	notify-send "ðŸ”Š Master volume UNMUTED"
    else
	notify-send "ðŸ”‡ Master volume MUTED"
    fi

    pactl set-sink-mute @DEFAULT_SINK@ toggle
}

get_volume(){
    isMuted=$(pactl get-sink-mute @DEFAULT_SINK@)
    volume=$(pactl get-sink-volume @DEFAULT_SINK@ | tail -n 2 | sed -e 's,.* \([0-9][0-9]*\)%.*,\1,' | head -n 1)

    if [ "${isMuted}" = 'Mute: yes' ]; then
	echo "$VOLUME_MUTED_ICON $volume%"
    else
	echo "$VOLUME_ON_ICON $volume%"
    fi
}

get_volume

case "$BLOCK_BUTTON" in 
    1) kill -39 $(pidof dwmblocks);; 
    2) mute; kill -39 $(pidof dwmblocks);;
esac
